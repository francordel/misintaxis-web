---
import Button from "./Button.astro";
---

<style>
  .signup__form {
    margin: 2rem 0;
    width: 100%;
    display: flex;
    max-width: 600px;
  }

  input[type="text"] {
    width: 100%;
    padding: 0.5rem 1rem;
    border: 2px solid #ccc;
    color: #000000;
    border-radius: 2rem;
    outline-style: none;
  }

  input:focus {
    border: 2px solid #000;
  }

  .signup__form :global(.btn) {
    margin-left: 1rem;
  }
</style>

<!-- Formulario -->
<form class="signup__form fade-in" id="analyzeForm">
  <input type="text" id="phraseInput" placeholder="Frase a analizar" required />
  <Button type="submit">Â¡Analiza! ðŸš€</Button>
</form>

<!-- Script para manejar el envÃ­o del formulario -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("analyzeForm");

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      const phrase = (document.getElementById("phraseInput") as HTMLInputElement).value;

      if (!phrase.trim()) {
        alert("Por favor, introduce una frase.");
        return;
      }

      try {
        const response = await fetch("/api/analyze", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: phrase }),
        });

        const result = await response.json();
        console.log(result);
        alert("AnÃ¡lisis generado con Ã©xito!");
      } catch (error) {
        console.error("Error en el anÃ¡lisis:", error);
        alert("Hubo un error al analizar la frase.");
      }
    });
  });
</script>

